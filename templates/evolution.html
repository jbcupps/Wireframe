<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKB Evolution</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
    <style>
        :root {
            --background: #121212;
            --surface: #1e1e1e;
            --surface-light: #2d2d2d;
            --primary: #6200ee;
            --primary-variant: #3700b3;
            --secondary: #03dac6;
            --secondary-variant: #018786;
            --error: #cf6679;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --border-color: #333333;
            
            /* SKB Colors */
            --skb1-color: #FF6E91;  /* Vivid pink */
            --skb2-color: #33C4FF;  /* Bright blue */
            --skb3-color: #65FF8F;  /* Bright green */
            --skb-merged: #BB86FC;  /* Purple */
            
            /* Evolution specific colors */
            --evo-compatible: #65FF8F;  /* Green for compatible */
            --evo-incompatible: #FF6E91;  /* Pink for incompatible */
            --evo-neutral: #33C4FF;  /* Blue for neutral */
            --evo-highlight: #FFCF33;  /* Yellow for highlighting */
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Site Header Styles */
        .site-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background-color: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            z-index: 1000;
            padding: 0 20px;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            height: 60px;
        }
        
        .site-logo {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--text-primary);
            text-decoration: none;
        }
        
        .site-nav {
            display: flex;
            gap: 20px;
        }
        
        .site-nav a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.2s ease;
            padding: 5px 0;
        }
        
        .site-nav a:hover, .site-nav a.active {
            color: var(--primary);
        }
        
        /* Main content padding for fixed header */
        .main-content {
            margin-top: 80px;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        header h1 {
            color: var(--text-primary);
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        header .subtitle {
            color: var(--text-secondary);
            font-size: 1.2rem;
            margin-bottom: 20px;
        }
        
        h2 {
            font-size: 1.5rem;
            font-weight: 400;
            margin-top: 0;
            color: var(--text-secondary);
        }
        
        .main-content {
            display: flex;
            flex-direction: row;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .visualization-panel {
            flex: 2;
            background-color: var(--surface);
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            position: relative;
            min-width: 300px;
            display: flex;
            flex-direction: column;
        }
        
        .plot-container {
            flex: 1;
            height: 500px;
            width: 100%;
            min-height: 400px;
            background-color: rgba(30, 30, 30, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: visible !important;
            display: block !important; /* Force display */
            z-index: 10; /* Ensure it's above other elements */
        }
        
        .controls-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-width: 300px;
        }
        
        .control-card {
            background-color: var(--surface);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }
        
        .card-header {
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-title {
            font-size: 1.1rem;
            font-weight: 500;
            margin: 0;
        }
        
        .population-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .population-card {
            background-color: var(--surface-light);
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
        }
        
        .population-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        /* Compatibility appearance properties */
        .compatibility-legend {
            display: flex;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }
        
        .compatible {
            border-left: 3px solid var(--evo-compatible);
        }
        
        .compatible .legend-color {
            background-color: var(--evo-compatible);
        }
        
        .incompatible {
            border-left: 3px solid var(--evo-incompatible);
        }
        
        .incompatible .legend-color {
            background-color: var(--evo-incompatible);
        }
        
        .neutral {
            border-left: 3px solid var(--evo-neutral);
        }
        
        .neutral .legend-color {
            background-color: var(--evo-neutral);
        }
        
        .highlighted {
            outline: 2px solid var(--evo-highlight);
        }
        
        .highlighted .legend-color {
            background-color: var(--evo-highlight);
        }
        
        .stable-hadron {
            border-left: 3px solid var(--skb-merged);
            position: relative;
            background-color: rgba(187, 134, 252, 0.15) !important;
        }
        
        .stable-hadron .legend-color {
            background-color: var(--skb-merged);
        }
        
        .stable-hadron-card {
            background-color: var(--surface-light);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 3px solid var(--skb-merged);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        
        .slider-container {
            margin-bottom: 15px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
            padding-right: 35px; /* Make room for the value display */
        }
        
        input[type="range"] {
            width: 100%;
            height: 4px;
            background: var(--surface-light);
            border-radius: 5px;
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
            margin-top: 8px;
            -webkit-appearance: none;
        }
        
        input[type="range"]:hover {
            opacity: 1;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--primary);
            cursor: pointer;
            border-radius: 50%;
            transition: all 0.2s;
        }
        
        .value-display {
            position: absolute;
            right: 0;
            top: 0;
            width: 30px;
            text-align: right;
            color: var(--primary);
            font-weight: 500;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
        }
        
        button {
            background-color: var(--primary);
            color: #000;
            border: none;
            padding: 10px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        button:hover {
            background-color: var(--primary-variant);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }
        
        .topological-properties {
            margin-top: 15px;
        }
        
        .property-row {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .property-name {
            color: var(--text-secondary);
        }
        
        .property-value {
            font-family: monospace;
            color: var(--primary);
        }
        
        .highlight-text {
            color: var(--evo-highlight);
            font-weight: bold;
        }
        
        .math-formula {
            font-family: 'Times New Roman', Times, serif;
            font-style: italic;
            padding: 10px;
            margin: 10px 0;
            background-color: var(--surface-light);
            border-radius: 5px;
            overflow-x: auto;
        }
        
        .generation-info {
            background-color: var(--surface-light);
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .info-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .info-value {
            font-size: 1.2rem;
            font-weight: 500;
            color: var(--primary);
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: pointer;
            margin-left: 5px;
        }
        
        .tooltip .tooltip-icon {
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--surface-light);
            color: var(--text-primary);
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        /* Navigation links at the top */
        .nav-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            padding: 10px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 1rem;
            transition: color 0.3s ease;
            padding: 5px 0;
        }
        
        .nav-links a:hover, .nav-links a.active {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
        }
        
        /* Dropdown Menu Styles */
        .nav-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-toggle {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .dropdown-toggle i {
            margin-left: 5px;
            transition: transform 0.3s ease;
        }
        
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            background-color: var(--bg-primary);
            min-width: 180px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 10px 0;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }
        
        .nav-dropdown:hover .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .nav-dropdown:hover .dropdown-toggle i {
            transform: rotate(180deg);
        }
        
        .dropdown-menu a {
            display: block;
            padding: 8px 15px;
            width: 100%;
            text-align: left;
        }
        
        .dropdown-menu a::after {
            display: none;
        }
        
        .dropdown-menu a:hover {
            background-color: var(--bg-secondary);
        }
        
        /* Mobile styles for dropdown */
        @media (max-width: 768px) {
            .nav-links {
                flex-direction: column;
                gap: 15px;
            }
            
            .dropdown-menu {
                position: static;
                opacity: 0;
                visibility: hidden;
                height: 0;
                transform: none;
                box-shadow: none;
                padding: 0;
                transition: opacity 0.3s ease;
            }
            
            .dropdown-menu.show {
                opacity: 1;
                visibility: visible;
                height: auto;
                padding: 10px 0;
                margin-top: 10px;
                margin-left: 15px;
                border-left: 2px solid var(--primary);
            }
            
            .dropdown-toggle {
                justify-content: space-between;
            }
            
            .nav-dropdown {
                width: 100%;
            }
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Responsive design */
        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
            }
            
            .plot-container {
                height: 400px;
            }
        }
        
        /* Footer styles */
        footer {
            padding: 40px 0;
            margin-top: 50px;
            border-top: 1px solid var(--border-color);
        }
        
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .footer-logo {
            font-size: 1.5rem;
            font-weight: 300;
            color: var(--primary);
        }
        
        .footer-links {
            display: flex;
            gap: 20px;
        }
        
        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-links a:hover {
            color: var(--primary);
        }
        
        .copyright {
            margin-top: 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Site Header -->
    <header class="site-header">
        <div class="header-content">
            <a href="/" class="site-logo">4D Manifold Explorer</a>
            <nav class="site-nav">
                <a href="/">Home</a>
                <a href="/evolution" class="active">Evolution</a>
                <div class="nav-dropdown">
                    <div class="dropdown-toggle">
                        <span>Quantum Physics</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="dropdown-menu">
                        <a href="/oscillator">Oscillator</a>
                        <a href="/double_slit">Double-Slit</a>
                        <a href="/quantum_tunneling">Quantum Tunneling</a>
                    </div>
                </div>
                <div class="nav-dropdown">
                    <div class="dropdown-toggle">
                        <span>Electromagnetism</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="dropdown-menu">
                        <a href="/maxwell">Maxwell</a>
                        <a href="/maxwells">Maxwell's</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <div class="container" style="padding-top: 80px;">
        <header>
            <h1>Evolutionary Algorithm for 4D Manifolds</h1>
            <p class="subtitle">Evolving Topological Structures for Compatibility</p>
            
            <div class="nav-links">
                <a href="/">Home</a>
                
                <div class="nav-dropdown">
                    <div class="dropdown-toggle">
                        <span>Manifold Physics</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="dropdown-menu">
                        <a href="/visualization">4D Manifold</a>
                        <a href="/topological_diffusion">Topological Diffusion</a>
                        <a href="/evolution" class="active">Evolution</a>
                    </div>
                </div>
                
                <div class="nav-dropdown">
                    <div class="dropdown-toggle">
                        <span>Quantum Physics</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="dropdown-menu">
                        <a href="/oscillator">Oscillator</a>
                        <a href="/double_slit">Double-Slit</a>
                        <a href="/quantum_tunneling">Quantum Tunneling</a>
                    </div>
                </div>
                
                <div class="nav-dropdown">
                    <div class="dropdown-toggle">
                        <span>Electromagnetism</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="dropdown-menu">
                        <a href="/maxwell">Maxwell-Boltzmann</a>
                        <a href="/maxwells">Maxwell's Equations</a>
                    </div>
                </div>
            </div>
            
            <!-- Stable Hadrons Section -->
            <div class="control-card" id="stable-hadrons-section" style="display: none; margin-bottom: 20px;">
                <div class="card-header">
                    <h3 class="card-title">Stable Hadrons Found</h3>
                    <div class="tooltip">
                        <i class="fas fa-info-circle tooltip-icon"></i>
                        <span class="tooltip-text">Sets of three Sub-SKBs that can form stable hadrons. These have been removed from the evolutionary process.</span>
                    </div>
                </div>
                
                <div id="stable-hadrons-container">
                    <!-- Stable hadrons will be listed here -->
                    <p id="no-stable-hadrons-message">No stable hadrons found yet. Continue evolving to find compatible triplets.</p>
                </div>
            </div>
        </header>
        
        <div class="main-content">
            <!-- Top Matched Triplets Panel -->
            <div class="controls-panel" style="flex: 1; min-width: 250px;">
                <div class="control-card">
                    <div class="card-header">
                        <h3 class="card-title">Top Matched Triplets</h3>
                        <div class="tooltip">
                            <i class="fas fa-info-circle tooltip-icon"></i>
                            <span class="tooltip-text">Triplets that best match the target quark configuration. Higher fitness values indicate better matches.</span>
                        </div>
                    </div>
                    
                    <div id="top-triplets-container">
                        <p id="no-triplets-message">Generate population and evolve to find triplets that match quark characteristics.</p>
                    </div>
                </div>
                
                <!-- Target Configuration -->
                <div class="control-card">
                    <div class="card-header">
                        <h3 class="card-title">Target Quark Configuration</h3>
                        <div class="tooltip">
                            <i class="fas fa-info-circle tooltip-icon"></i>
                            <span class="tooltip-text">The target quark configuration we are evolving toward. Currently set to a proton with two up quarks and one down quark.</span>
                        </div>
                    </div>
                    
                    <div class="topological-properties">
                        <div class="property-row">
                            <span class="property-name">Quark 1 (Up)</span>
                            <span class="property-value">T = 2, Q = 2/3</span>
                        </div>
                        <div class="property-row">
                            <span class="property-name">Quark 2 (Up)</span>
                            <span class="property-value">T = 2, Q = 2/3</span>
                        </div>
                        <div class="property-row">
                            <span class="property-name">Quark 3 (Down)</span>
                            <span class="property-value">T = -1, Q = -1/3</span>
                        </div>
                        <div class="property-row">
                            <span class="property-name">Total Charge</span>
                            <span class="property-value">Q = 1</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Visualization Panel -->
            <div class="visualization-panel">
                <div class="generation-info">
                    <div class="info-item">
                        <span class="info-label">Generation</span>
                        <span class="info-value" id="generation-count">0</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Population Size</span>
                        <span class="info-value" id="population-size">20</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Best Fitness</span>
                        <span class="info-value" id="best-fitness">0.00</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Compatible Pairs</span>
                        <span class="info-value" id="compatible-count">0</span>
                    </div>
                </div>
                
                <div id="evolution-plot" class="plot-container"></div>
                
                <div class="control-card">
                    <div class="card-header">
                        <h3 class="card-title">Evolution Controls</h3>
                    </div>
                    
                    <div class="button-group">
                        <button id="generate-btn" title="Generate new population">
                            <i class="fas fa-sync"></i> Generate Population
                        </button>
                        <button id="step-btn" title="Run one generation">
                            <i class="fas fa-step-forward"></i> Step
                        </button>
                        <button id="run-btn" title="Run continuously">
                            <i class="fas fa-play" id="run-icon"></i> <span id="run-text">Run</span>
                        </button>
                        <button id="reset-btn" title="Reset evolution">
                            <i class="fas fa-undo"></i> Reset
                        </button>
                        <button id="find-hadrons-btn" title="Find stable hadrons">
                            <i class="fas fa-search"></i> Find Hadrons
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Controls Panel -->
            <div class="controls-panel">
                <!-- Algorithm Parameters -->
                <div class="control-card">
                    <div class="card-header">
                        <h3 class="card-title">Algorithm Parameters</h3>
                    </div>
                    
                    <div class="slider-container">
                        <label for="population-size-slider">Population Size <span id="population-size-value" class="value-display">20</span></label>
                        <input type="range" id="population-size-slider" min="10" max="50" value="20" step="1">
                        <div class="tooltip">
                            <i class="fas fa-info-circle tooltip-icon"></i>
                            <span class="tooltip-text">Number of Sub-SKB configurations in each generation.</span>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <label for="mutation-rate-slider">Mutation Rate <span id="mutation-rate-value" class="value-display">0.1</span></label>
                        <input type="range" id="mutation-rate-slider" min="0" max="0.5" value="0.1" step="0.01">
                        <div class="tooltip">
                            <i class="fas fa-info-circle tooltip-icon"></i>
                            <span class="tooltip-text">Probability of mutation for each parameter in a Sub-SKB.</span>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <label for="selection-pressure-slider">Selection Pressure <span id="selection-pressure-value" class="value-display">3</span></label>
                        <input type="range" id="selection-pressure-slider" min="1" max="5" value="3" step="1">
                        <div class="tooltip">
                            <i class="fas fa-info-circle tooltip-icon"></i>
                            <span class="tooltip-text">Tournament size for selection. Higher values increase selection pressure towards fitter individuals.</span>
                        </div>
                    </div>
                </div>
                
                <!-- Fitness Function Weights -->
                <div class="control-card">
                    <div class="card-header">
                        <h3 class="card-title">Fitness Function Weights</h3>
                        <div class="tooltip">
                            <i class="fas fa-info-circle tooltip-icon"></i>
                            <span class="tooltip-text">Adjust the importance of different topological properties in the fitness function.</span>
                        </div>
                    </div>
                    
                    <div class="math-formula">
                        F(S₁, S₂) = α·Compatibility(w₁) + β·|χₑᵤₗₑᵣ - χₜₐᵣₒₑₜ|⁻¹ + γ·Definiteness(Q) + δ·TwistAlignment + ε·CTCStability
                    </div>
                    
                    <div class="slider-container">
                        <label for="w1-weight-slider">Stiefel-Whitney Weight (α) <span id="w1-weight-value" class="value-display">1.0</span></label>
                        <input type="range" id="w1-weight-slider" min="0" max="2" value="1.0" step="0.1">
                    </div>
                    
                    <div class="slider-container">
                        <label for="euler-weight-slider">Euler Characteristic Weight (β) <span id="euler-weight-value" class="value-display">1.0</span></label>
                        <input type="range" id="euler-weight-slider" min="0" max="2" value="1.0" step="0.1">
                    </div>
                    
                    <div class="slider-container">
                        <label for="q-weight-slider">Intersection Form Weight (γ) <span id="q-weight-value" class="value-display">1.0</span></label>
                        <input type="range" id="q-weight-slider" min="0" max="2" value="1.0" step="0.1">
                    </div>
                    
                    <div class="slider-container">
                        <label for="twist-weight">Twist Alignment Weight (δ) <span id="twist-weight-value" class="value-display">1.0</span></label>
                        <input type="range" id="twist-weight" min="0" max="2" step="0.1" value="1.0">
                        <div class="tooltip">
                            <i class="fas fa-info-circle tooltip-icon"></i>
                            <span class="tooltip-text">Weight for twist alignment in the fitness function. Higher values prioritize Sub-SKBs with complementary twists.</span>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <label for="ctc-weight">CTC Stability Weight (ε) <span id="ctc-weight-value" class="value-display">1.0</span></label>
                        <input type="range" id="ctc-weight" min="0" max="2" step="0.1" value="1.0">
                        <div class="tooltip">
                            <i class="fas fa-info-circle tooltip-icon"></i>
                            <span class="tooltip-text">Weight for the CTC stability component in the fitness function. Higher values favor configurations where time twist parameters across Sub-SKBs are balanced, producing stable closed timelike curves that support quantum information processing.</span>
                        </div>
                    </div>
                </div>
                
                <!-- Target Values -->
                <div class="control-card">
                    <div class="card-header">
                        <h3 class="card-title">Target Topological Properties</h3>
                        <div class="tooltip">
                            <i class="fas fa-info-circle tooltip-icon"></i>
                            <span class="tooltip-text">Define target values for topological properties of a stable hadron.</span>
                        </div>
                    </div>
                    
                    <div class="slider-container">
                        <label for="target-euler-slider">Target Euler Characteristic <span id="target-euler-value" class="value-display">0</span></label>
                        <input type="range" id="target-euler-slider" min="-4" max="4" value="0" step="1">
                    </div>
                    
                    <div class="slider-container">
                        <label for="target-orientability">Target Orientability</label>
                        <select id="target-orientability" class="form-select">
                            <option value="orientable">Orientable (w₁ = 0)</option>
                            <option value="non-orientable">Non-orientable (w₁ ≠ 0)</option>
                        </select>
                    </div>
                    
                    <div class="slider-container">
                        <label for="target-q-form">Target Intersection Form</label>
                        <select id="target-q-form" class="form-select">
                            <option value="positive-definite">Positive Definite</option>
                            <option value="negative-definite">Negative Definite</option>
                            <option value="indefinite" selected>Indefinite (Hadron-Like)</option>
                        </select>
                        <div class="tooltip">
                            <i class="fas fa-info-circle tooltip-icon"></i>
                            <span class="tooltip-text">Indefinite intersection forms are ideal for hadron-like SKBs, better supporting confinement energy patterns.</span>
                        </div>
                    </div>
                </div>
                
                <!-- Selected Sub-SKB Details -->
                <div class="control-card">
                    <div class="card-header">
                        <h3 class="card-title">Selected Sub-SKB Details</h3>
                    </div>
                    
                    <div id="sub-skb-details">
                        <p>Select a Sub-SKB from the population to see details</p>
                    </div>
                    
                    <div class="topological-properties" id="selected-properties" style="display: none;">
                        <h4>Topological Properties</h4>
                        
                        <div class="property-row">
                            <span class="property-name">First Stiefel-Whitney Class (w₁)</span>
                            <span class="property-value" id="selected-w1">N/A</span>
                        </div>
                        
                        <div class="property-row">
                            <span class="property-name">Euler Characteristic (χ)</span>
                            <span class="property-value" id="selected-euler">N/A</span>
                        </div>
                        
                        <div class="property-row">
                            <span class="property-name">Fundamental Group (π₁)</span>
                            <span class="property-value" id="selected-pi1">N/A</span>
                        </div>
                        
                        <div class="property-row">
                            <span class="property-name">Intersection Form (Q)</span>
                            <span class="property-value" id="selected-q">N/A</span>
                        </div>
                        
                        <div class="property-row">
                            <span class="property-name">Kirby-Siebenmann (ks)</span>
                            <span class="property-value" id="selected-ks">N/A</span>
                        </div>
                        
                        <div class="property-row">
                            <span class="property-name">Fitness</span>
                            <span class="property-value" id="selected-fitness">N/A</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Population Display -->
        <div class="control-card" style="margin-top: 20px;">
            <div class="card-header">
                <h3 class="card-title">Sub-SKB Population</h3>
                <div class="tooltip">
                    <i class="fas fa-info-circle tooltip-icon"></i>
                    <span class="tooltip-text">Current population of Sub-SKB configurations. Click on individuals to select them.</span>
                </div>
            </div>
            
            <!-- Compatibility appearance legend -->
            <div class="compatibility-legend">
                <div class="legend-item compatible">
                    <div class="legend-color"></div>
                    <span>Compatible: Topologically viable for hadron formation</span>
                </div>
                <div class="legend-item incompatible">
                    <div class="legend-color"></div>
                    <span>Incompatible: Cannot form stable hadrons</span>
                </div>
                <div class="legend-item neutral">
                    <div class="legend-color"></div>
                    <span>Neutral: Partially compatible configuration</span>
                </div>
                <div class="legend-item highlighted">
                    <div class="legend-color"></div>
                    <span>Selected: Currently being examined</span>
                </div>
                <div class="legend-item stable-hadron">
                    <div class="legend-color"></div>
                    <span>Stable Hadron: Part of a compatible triplet</span>
                </div>
            </div>
            
            <div class="population-grid" id="population-grid">
                <!-- Population members will be dynamically inserted here -->
            </div>
        </div>
    </div>
    
    <script>
        // Basic UI functionality
        function updateSliderValue(id) {
            const slider = document.getElementById(id);
            if (!slider) {
                console.error(`Could not update slider value: ${id} - Slider not found`);
                return;
            }
            
            // Try finding the display element with the ID format: id + '-value'
            const display = document.getElementById(id + '-value');
            if (display) {
                display.textContent = slider.value;
                console.log(`Updated ${id} to value: ${slider.value}`);
                return;
            }
            
            // If that fails, look for a sibling span with class 'slider-value' or 'value-display'
            const nextSibling = slider.nextElementSibling;
            if (nextSibling && (nextSibling.classList.contains('slider-value') || 
                                nextSibling.classList.contains('value-display'))) {
                nextSibling.textContent = slider.value;
                console.log(`Updated ${id} to value: ${slider.value} (sibling format)`);
                return;
            }
            
            // If neither works, look within the same container for a span with either class
            const container = slider.closest('.slider-container');
            if (container) {
                const valueSpan = container.querySelector('.slider-value, .value-display');
                if (valueSpan) {
                    valueSpan.textContent = slider.value;
                    console.log(`Updated ${id} to value: ${slider.value} (container format)`);
                    return;
                }
            }
            
            console.error(`Could not update slider value: ${id} - Value display not found in any format`);
        }
        
        // Initialize sliders
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Initializing sliders for evolutionary programming interface");
            
            // Check if Plotly is loaded
            if (typeof Plotly === 'undefined') {
                console.error("Plotly library is not loaded! This will prevent visualizations from working.");
                alert("Visualization library (Plotly) failed to load. Please try refreshing the page.");
            } else {
                console.log("Plotly visualization library loaded successfully: v" + Plotly.version);
            }
            
            // Initialize all slider values
            document.querySelectorAll('input[type="range"]').forEach(slider => {
                updateSliderValue(slider.id);
                
                // Add event listeners to each slider to update values when moved
                slider.addEventListener('input', function() {
                    updateSliderValue(this.id);
                });
            });
            
            console.log("Evolutionary Programming interface loaded successfully");
            
            // Display the compatibility legend explanation
            console.log("Compatibility appearance standards loaded: compatible (green), incompatible (red), neutral (blue), highlighted (yellow)");
        });
    </script>
    <script src="/static/js/evolution.js"></script>
    
    <!-- Theory and Mathematics Section -->
    <div class="container">
        <div class="control-card" style="margin-top: 30px; margin-bottom: 30px;">
            <div class="card-header">
                <h3 class="card-title">Theory & Mathematics</h3>
            </div>
            <div style="padding: 15px;">
                <h4>Evolutionary Algorithms in Topological Physics</h4>
                <p>
                    Evolutionary algorithms are computational methods inspired by biological evolution, using mechanisms of selection, recombination, and mutation to search for optimal solutions. In the context of 4D manifold physics, these algorithms help explore the vast configuration space of topological structures.
                </p>
                
                <h4>Key Mathematical Concepts</h4>
                <ul style="padding-left: 20px; margin: 15px 0;">
                    <li><strong>Stiefel-Whitney Classes:</strong> Topological invariants (w₁, w₂, etc.) that characterize the non-orientability of manifolds.</li>
                    <li><strong>Euler Characteristic (χ):</strong> A topological invariant calculated as χ = 2 - 2g, where g is the genus, measuring the manifold's complexity.</li>
                    <li><strong>Intersection Form (Q):</strong> A bilinear form defining how topological cycles intersect, crucial for understanding how 4D manifolds behave under deformation.</li>
                    <li><strong>Fitness Function:</strong> Mathematically expressed as:
                        <div class="math-formula" style="text-align: center;">
                            F(S₁, S₂) = α·Compatibility(w₁) + β·|χₑᵤₗₑᵣ - χₜₐᵣₒₑₜ|⁻¹ + γ·Definiteness(Q) + δ·TwistAlignment + ε·CTCStability
                        </div>
                    </li>
                </ul>

                <h4>Applications in Theoretical Physics</h4>
                <p>
                    The exploration of 4D manifolds through evolutionary algorithms has several significant applications:
                </p>
                
                <ul style="padding-left: 20px; margin: 15px 0;">
                    <li><strong>Particle Physics Models:</strong> Identifying topological configurations that could represent fundamental particles and their interactions.</li>
                    <li><strong>Quantum Gravity:</strong> Exploring possible spacetime structures that reconcile quantum mechanics and general relativity.</li>
                    <li><strong>Topological Quantum Computing:</strong> Finding manifolds with properties suitable for error-resistant quantum computation.</li>
                    <li><strong>Emergence of Physical Laws:</strong> Understanding how topological constraints might give rise to the fundamental laws of physics.</li>
                </ul>
                
                <h4>Historical Development</h4>
                <p>
                    The marriage of evolutionary computing and topology has its roots in diverse fields:
                </p>
                <p>
                    Evolutionary algorithms were first formalized in the 1960s and 1970s by researchers like John Holland, who developed genetic algorithms, and Ingo Rechenberg, who pioneered evolution strategies. These computational approaches drew inspiration from Darwin's theory of natural selection.
                </p>
                <p>
                    The mathematical theory of 4D manifolds was developed throughout the 20th century, with significant contributions from mathematicians like Michael Freedman, Simon Donaldson, and Edward Witten, who connected topology with quantum field theory, leading to revolutionary insights in both mathematics and theoretical physics.
                </p>
                <p>
                    The application of evolutionary algorithms to topological physics gained momentum in the early 21st century as computational power increased, enabling researchers to explore complex configuration spaces that were previously inaccessible through analytical methods alone.
                </p>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">4D Manifold Explorer</div>
                <div class="footer-links">
                    <a href="/">Home</a>
                    <a href="/visualization">4D Manifold</a>
                    <a href="/evolution">Evolution</a>
                    <a href="/oscillator">Oscillator</a>
                </div>
            </div>
            <div class="copyright">
                &copy; 2024 4D Manifold Explorer. All rights reserved.
            </div>
        </div>
    </footer>
    
    <!-- Navigation Dropdown JS -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Add active class to parent dropdown if child link is active
            const activeLinks = document.querySelectorAll('.dropdown-menu a.active');
            activeLinks.forEach(link => {
                const parentDropdown = link.closest('.nav-dropdown');
                const dropdownToggle = parentDropdown.querySelector('.dropdown-toggle');
                dropdownToggle.classList.add('active');
            });
            
            // Handle click on dropdown toggle (for mobile)
            const dropdownToggles = document.querySelectorAll('.dropdown-toggle');
            dropdownToggles.forEach(toggle => {
                toggle.addEventListener('click', function(e) {
                    // Only apply this on mobile
                    if (window.innerWidth <= 768) {
                        e.preventDefault();
                        const dropdown = this.closest('.nav-dropdown');
                        const dropdownMenu = dropdown.querySelector('.dropdown-menu');
                        
                        // Close all other menus
                        document.querySelectorAll('.dropdown-menu').forEach(menu => {
                            if (menu !== dropdownMenu) {
                                menu.classList.remove('show');
                            }
                        });
                        
                        // Toggle this menu
                        dropdownMenu.classList.toggle('show');
                    }
                });
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.nav-dropdown')) {
                    document.querySelectorAll('.dropdown-menu').forEach(menu => {
                        menu.classList.remove('show');
                    });
                }
            });
        });
    </script>
</body>
</html> 